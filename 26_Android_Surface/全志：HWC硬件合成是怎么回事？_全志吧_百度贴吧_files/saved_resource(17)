_.Module.define({path:"puser/component/Guide",sub:{initial:function(){},initMagicGuide:function(){var i=$.cookie("PROPS_MAGIC_GUIDE");i||($.cookie("PROPS_MAGIC_GUIDE","true",{expires:30}),this.showMagicGuide())},showMagicGuide:function(i){this.propsId=i,this.builGuideUI(),this.buildGuideEvents(),this.initGuideFlash()},initPreviewUI:function(){this.builGuideUI(),this.buildGuideEvents()},builGuideUI:function(){this.$mask=new $.modal({show:!0});var i=$('<div class="guide_wrap"></div>'),e=$('<div class="guide_content"></div>'),s=$('<a href="#" class="guide_close"></a>');i.append(e).append(s),$("body").append(i),i.css({"z-index":$.getzIndex()}),this.$guideWrap=i,this.$guideContent=e,this.$guideClose=s},buildGuideEvents:function(){var i=this;this.$mask.bind("click",function(){i.closeGuide()}),this.$guideClose.bind("click",function(){return i.closeGuide(),!1})},closeGuide:function(){this.$guideWrap.remove(),this.$mask.remove()},initGuideFlash:function(){this.buildFlashUI(),this.buildFlashEvents()},buildFlashUI:function(){{var i=this,e="1070002"==this.propsId?"egg":"worship",s="/tb/static-puser/swf/guide_"+e+".swf?t=140112";new $.swf(s,{container:i.$guideContent,width:980,height:600,params:{wmode:"transparent"}})}this.$guideWrap.addClass("guide_wrap_magic")},buildFlashEvents:function(){var i=this,e={};e.finishPlay=function(){i.closeGuide()},window.MagicProps=e}}});_.Module.define({path:"puser/widget/MagicProps",requires:["puser/widget/Residual","puser/component/Guide"],sub:{initial:function(t){this.$wrap=t.wrap,this.dataObj=t.propsData,this.visible=!1,this.initOptions(),this.loadComponent(),this.buildProps()},initOptions:function(){this.propsOptions={1070001:{key:"worship",name:"\u9B54\u62DC",flashOptions:{width:320,height:390,marginLeft:0,marginTop:0}},1070002:{key:"egg",name:"\u9B54\u86CB",flashOptions:{width:900,height:600,marginLeft:384,marginTop:70}}},this.mallurl="/tbmall/propslist?category=107",this.poolSize=5;var t=window.navigator.userAgent.match(/chrome/i);this.page=t?$(document.body):$(document.documentElement)},loadComponent:function(){this.residual=this.use("puser/widget/Residual"),this.guide=this.use("puser/component/Guide")},buildProps:function(){this.initPropsData(),this.propsList.length>0&&(this.visible=!0,this.initPropsUI(),this.bindPropsEvents())},initPropsData:function(){for(var t=this.dataObj.owner||{},i=null,a=null,s=[],e={},o=["1070001","1070002"],r=0;r<o.length;r++)a=o[r],i={id:a,count:t[a]&&t[a].left_num||0},$.extend(i,this.propsOptions[a]),s.push(i),e[a]=i;this.propsList=s,this.propsMap=e},initPropsUI:function(){for(var t=this,i=$('<ul class="tbui_aside_props_list clearfix" id="tbui_aside_props_list"></ul>'),a=new Array,s=null,e=0;e<t.propsList.length;e++)s=t.propsList[e],a.push('<li class="props_item props_item_'+s.id+'">'),s.count>0?a.push('<a class="j_props_btn props_item_btn" href="#" data-id="'+s.id+'"><img src="/tb/static-puser/img/props/'+s.key+'.png"/></a>'):a.push('<a class="props_item_btn" target="_blank" href="'+t.mallurl+'" data-id="'+s.id+'"><img src="/tb/static-puser/img/props/'+s.key+'.png"/><span class="props_buy_icon"></span></a>'),a.push('<p class="props_item_title">'),a.push("<span>"+s.name+"</span>"),s.count>0&&(a.push('<span class="props_item_sign">'+String.fromCharCode(215)+"</span>"),a.push('<span class="props_item_num">'+s.count+"</span>")),a.push("</p>"),a.push("</li>");i.html(a.join("")),i.hide().appendTo(t.$wrap),t.$propsList=i},bindPropsEvents:function(){var t=this;t.$wrap.delayhover({enterDelay:300,leaveDelay:700,mouseenter:function(){t.$propsList.fadeIn(),t.guide.initMagicGuide()},mouseleave:function(){t.$propsList.fadeOut()}}).children("a").click(function(t){t.preventDefault(),t.stopPropagation()}),t.$propsList.delegate(".j_props_btn","click",function(){var i=$(this).data("id"),a=t.propsMap[i];return t.propsObj=a,a.count>0&&("pb"==PageData.product?t.buildPostArea():"ihome"==PageData.product&&t.buildIhomeArea(),t.buildMask(),t.initFlashCallbacks()),!1})},buildIhomeArea:function(){var t={jdom:$("div.userinfo_wrap"),userId:this.dataObj.home_user_id,propsData:this.dataObj.home_user_props,propsType:0},i=$("#headinfo_wrap"),a=i.offset().left,s=i.offset().top,e=a+i.width(),o={marginLeft:a,marginRight:e,marginTop:s,marginBottom:$("body").height()-28};$.extend(t,o),this.limitArea=o,this.areaList=[t]},buildPostArea:function(){for(var t=$("#j_p_postlist"),i=t.find(".l_post"),a=null,s=null,e=[],o=t.offset().left,r=t.offset().top,p=o+t.width(),n=0;n<i.length;n++)a=$(i[n]),s=a.getData(),this.doPostItem(a,s,o,p,e);var l={marginLeft:o,marginRight:p,marginTop:r,marginBottom:r+t.height()};this.limitArea=l,this.areaList=e},doPostItem:function(t,i,a,s,e){var o=null,r=null,p=null,n=t.offset().top,l=n+t.height(),h={userId:i.author.user_id,postId:i.content.post_id,propsData:i.content.props,marginTop:n,marginBottom:l};r={},o=t.find(".d_author"),r.jdom=o,r.marginRight=a+130,r.marginLeft=a,$.extend(r,h),e.push(r),p={},o=t.find(".d_post_content_main"),p.jdom=o,p.marginRight=s,p.marginLeft=a+130,$.extend(p,h),e.push(p)},buildMask:function(){this.flashPool=[],this.currScrollTop=0,this.currAreaObj=null,this.initMask(),this.setMaskPosition(0,0,0,0),this.bindMaskEvents()},initMask:function(){var t=$('<div class="mask_layer mask_top"></div>'),i=$('<div class="mask_layer mask_right"></div>'),a=$('<div class="mask_layer mask_bottom"></div>'),s=$('<div class="mask_layer mask_left"></div>'),e=$('<div class="mask_layer light_area"></div>'),o=$('<div id="mask_wrap" class="mask_wrap mouse_'+this.propsObj.key+'"></div>');o.append(t).append(i).append(a).append(s).append(e).css({"z-index":$.getzIndex()}),$("body").append(o),this.$maskWrap=o,this.maskMap={topMask:t,rightMask:i,bottomMask:a,leftMask:s,lightArea:e}},setMaskPosition:function(t,i,a,s){var e=this.maskMap;e.topMask.css({height:i}),e.rightMask.css({left:t+a,top:i,width:$("body").width()-(t+a),height:s}),e.bottomMask.css({top:i+s,height:$("body").height()-(i+s)}),e.leftMask.css({top:i,width:t,height:s}),e.lightArea.css({left:t,top:i,width:a,height:s})},bindMaskEvents:function(){var t=this;$("body").bind("contextmenu",function(){return!1}),$(document).bind("keydown",function(i){if(27==i.which&&null!=t.$maskWrap){if(t.disabledMove)return!1;t.clear()}}),t.$maskWrap.mousedown(function(i){if(3==i.which){if(t.disabledMove)return!1;t.clear()}return!1});var i=50,a=$("body").width()-i,s=0;t.$maskWrap.mousemove(function(i){if(t.$bulletLayer||(t.$bulletLayer=t.buildBulletLayer(),t.$maskWrap.append(t.$bulletLayer)),s=i.pageX,s>a&&(s=a),t.$bulletLayer.css({left:s,top:i.pageY}),t.disabledMove)return!1;var e=null,o=t.limitArea;if(t.isInArea=i.pageX>=o.marginLeft&&i.pageX<=o.marginRight&&i.pageY>=o.marginTop&&i.pageY<=o.marginBottom?!0:!1,t.isInArea)for(var r=0;r<t.areaList.length;r++)e=t.areaList[r],i.pageX>=e.marginLeft&&i.pageX<=e.marginRight&&i.pageY>=e.marginTop&&i.pageY<=e.marginBottom&&(t.setMaskPosition(e.marginLeft,e.marginTop,e.marginRight-e.marginLeft,e.marginBottom-e.marginTop),e.propsType=r%2,t.areaObj=e);else t.setMaskPosition(0,0,0,0)})},buildBulletLayer:function(){var t=this,i=$('<div class="bullet_layer"><span class="bullet_layer_tip">\u53F3\u952E\u53D6\u6D88</span></div>');return i.click(function(){t.isInArea?t.propsObj.count>0?t.flashPool.length<=t.poolSize&&(t.updatePosition(),t.post()):t.showTomallDialog():t.clear()}),i},clear:function(){this.clearPool(),this.$maskWrap.remove(),this.$maskWrap=null,this.$bulletLayer=null,setTimeout(function(){$("body").unbind("contextmenu")},300)},post:function(){var t=this,i="/tbmall/post/useAppraiseProps",a={props_id:t.propsObj.id,target_user_id:t.areaObj.userId||"",type:t.areaObj.propsType,post_id:t.areaObj.postId||"",tbs:PageData.tbs};$.tb.post(i,a,function(i){i&&0==i.no&&t.updatePage()})},updatePage:function(){var t=this.propsObj.id,i=".props_item_"+t;this.updatePropsBtnNum(t,i),("ihome"==PageData.product||"1"==this.areaObj.propsType)&&this.updatePostAreaNum(t,i)},updatePropsBtnNum:function(t,i){var a=$("#tbui_aside_props_list "+i),s=this.propsObj.count-1;s=s>0?s:0,this.propsObj.count=s,s>0?a.find(".props_item_num").text(s):(a.find(".props_item_btn").removeClass("j_props_btn").tbattr("target","_blank").tbattr("href",this.mallurl).append('<span class="props_buy_icon"></span>'),a.find(".props_item_sign").remove(),a.find(".props_item_num").remove())},updatePostAreaNum:function(t,i){var a=this.areaObj.propsData||{};a[t]||(this.areaObj.propsData={},this.areaObj.propsData[t]={num:0});var s=this.areaObj.propsData[t].num+1;s=s>0?s:0,this.areaObj.propsData[t].num=s;var e=this.areaObj.jdom.find("ul.props_appraise_wrap"),o=e.find(i);o[0]?o.find(".props_item_num").text(s):(htmlArr=[],htmlArr.push('<li class="props_item props_item_split"><span class="userinfo_split"></span></li>'),htmlArr.push('<li class="props_item props_item_'+t+'">'),htmlArr.push('<a href="#" data-postid="'+(this.areaObj.postId||"")+'" data-id="'+t+'" class="props_item_icon"></a>'),htmlArr.push('<span class="props_item_plus">'+String.fromCharCode(215)+"</span>"),htmlArr.push('<span class="props_item_num">'+s+"</span></li>"),"1070001"==t?e.prepend($(htmlArr.join(""))):"1070002"==t&&e.append($(htmlArr.join(""))))},updatePosition:function(){var t=this,i=this.propsOptions[this.propsObj.id].flashOptions,a=($(window).height()-i.height)/2;a=150>a?150:a;var s=this.areaObj.jdom.offset().top-a;this.disabledMove=!0;var e=$(window).scrollTop();0==e||e!=this.currScrollTop||this.currAreaObj&&this.currAreaObj.marginTop!=this.areaObj.marginTop?(this.currAreaObj=this.areaObj,this.currScrollTop=e,t.page.animate({scrollTop:s},300,"swing",function(){t.buildFlash(s)})):t.buildFlash(s)},buildFlash:function(t){var i=this,a=0,s=0,e=$('<div class="props_flash_wrap"></div>'),o=this.propsOptions[this.propsObj.id].flashOptions,r=($(window).width()-o.width)/2,p=t+o.marginTop;r=r>0?r:0,p=p>0?p:0,"0"==i.areaObj.propsType&&"1070002"==i.propsObj.id&&("ihome"==PageData.product?(a=100,s=-15):(a=60,s=-20),r=r-(r+o.marginLeft-i.areaObj.jdom.offset().left)+a,p+=s),e.css({width:o.width,height:o.height,left:r,top:p,"z-index":$.getzIndex()});{var n="/tb/static-puser/swf/"+this.propsObj.key+".swf?t=140107";new $.swf(n,{container:e,width:o.width,height:o.height,params:{wmode:"transparent"}})}i.flashPool.push(e),i.$maskWrap.append(e),i.topzIndex=$.getzIndex(),i.$bulletLayer.css({"z-index":i.topzIndex})},buildPlusOne:function(){var t=this,i="plusone_"+this.propsObj.key;$.browser.msie&&6==$.browser.version&&(i+="_png8"),i="/tb/static-puser/img/"+i+".png";var a=$('<div class="props_plusone"><img src="'+i+'"/></div>'),s=0,e=0;"ihome"==PageData.product?(s=t.areaObj.marginLeft+70,e=t.areaObj.marginTop+300):(s=t.areaObj.marginLeft+(t.areaObj.marginRight-t.areaObj.marginLeft)/2-18,e=t.areaObj.marginTop+100),a.css({left:s,top:e,"z-index":t.topzIndex+1}),t.$maskWrap.append(a),a.animate({top:"-=100px",opacity:.8},800,"swing",function(){a.remove()})},clearPool:function(){for(var t=this,i=t.flashPool,a=null,s=0;s<i.length;s++)a=i.shift(),a.remove();t.disabledMove=!1},initFlashCallbacks:function(){var t=this,i={},a=null;i.finishPlay=function(){if(t.flashPool.length>0){t.buildPlusOne();var i=t.flashPool.shift();i.remove(),t.flashPool.length<=0&&(t.disabledMove=!1,"0"==t.areaObj.propsType&&("ihome"==PageData.product?a=t.areaObj.jdom.find(".userinfo_left"):"pb"==PageData.product&&(a=t.areaObj.jdom.find(".icon_relative")),t.residual.showUI({wrap:a,key:t.propsObj.key})))}},window.MagicProps=i},showTomallDialog:function(){var t=this,i=new $.dialog({title:"\u63D0\u793A",html:'<div class="props_buy_dialog"><p class="buy_dialog_content">\u4F60\u76EE\u524D\u6CA1\u6709\u53EF\u7528\u7684\u9053\u5177\u4E86\uFF0C\u5FEB\u53BB\u5546\u57CE\u8D2D\u4E70\u5427</p><a class="buy_dialog_link" target="_blank" href="'+t.mallurl+'">\u53BB\u8D2D\u4E70>></a><div>',width:400,height:80});i.element.find(".buy_dialog_link").on("click",function(){t.clear(),setTimeout(function(){t.showBuyDialog(t.mallurl)},200)})},showBuyDialog:function(t){var i='<p class="buy_txt">\u9053\u5177\u8D2D\u4E70\u6210\u529F\u540E\u5373\u53EF\u4F7F\u7528\uFF01</p><div class="buy_dialog_btns"><a href="#" class="ui_btn ui_btn_m btn_success"><span><em>\u8D2D\u4E70\u6210\u529F</em></span></a><a href="#{href}" target="_blank"  class="ui_btn ui_btn_sub_m btn_failure"><span><em>\u8D2D\u4E70\u5931\u8D25\uFF0C\u91CD\u65B0\u8D2D\u4E70</em></span></a></div>',a=new $.dialog({title:"\u63D0\u793A",html:$.tb.format(i,{href:$.tb.unescapeHTML(t)}),width:400,height:80});a.bind("onclose",function(){$.tb.location.reload()}),a.element.find(".btn_success").on("click",function(t){t.preventDefault(),$.tb.location.reload()})}}});_.Module.define({path:"puser/widget/Feedback",requires:[],sub:{initial:function(i){this.dataObj=i,this.initOptions(),this.initCallbacks(),this.initData(),this.play()},initOptions:function(){this.options={1070001:{id:"1070001",key:"worship",name:"\u819C\u62DC",flashOptions:{width:250,height:220,marginLeft:120,marginTop:95}},1070002:{id:"1070002",key:"egg",name:"\u81ED\u9E21\u86CB",flashOptions:{width:410,height:260,marginLeft:195,marginTop:30}}}},initData:function(){for(var i=this.dataObj.appraise||{},t=null,e=null,a=[],n=["1070001","1070002"],s=0;s<n.length;s++)t=i[n[s]],t&&t.notice>0&&(e=this.options[n[s]],$.extend(e,t),a.push(e));this.playList=a},play:function(){var i=this.playList;i.length>0&&(i.sort(function(i,t){return t.notice!=i.notice?t.notice-i.notice:parseInt(t.id)-parseInt(i.id)}),this.index=0,this.buildFlash(),this.clearNotice())},buildFlash:function(){if(this.index<this.playList.length){var i=$('<div class="props_flash_wrap"></div>');$("body").append(i);var t=this.playList[this.index],e=this.getFlashData(t);i.css({width:e.width,height:e.height,left:e.marginLeft,top:e.marginTop,"z-index":e.zindex});{var a="/tb/static-puser/swf/"+e.feedbackName+"?t=0101";new $.swf(a,{id:"props_flash_content",name:"props_flash_content",container:i,width:e.width,height:e.height,params:{wmode:"transparent"}})}t.wrap=i}},getFlashData:function(i){var t=i.flashOptions,e=0,a=0,n=0,s=0,o=PageData.product;switch(o){case"pb":case"frs":case"index":n=40,e=$("#user_info").offset().left,a=$("#user_info").offset().top;break;case"ihome":n=92,e=$("#userinfo_wrap").offset().left,a=$("#userinfo_wrap").offset().top}e=e-t.marginLeft+n,a=a-t.marginTop+s;var h=i.notice>1?"more":"single";return feedbackName="feedback_"+i.key+"_"+h+".swf",{key:i.key,feedbackName:feedbackName,width:t.width,height:t.height,marginLeft:e,marginTop:a,zindex:$.getzIndex()}},clearNotice:function(){var i="/tbmall/post/clearAppraiseNotice",t={type:0,tbs:PageData.tbs};$.tb.post(i,t,function(i){i&&0==i.no})},initCallbacks:function(){var i=this,t={};t.finishPlay=function(){i.playList[i.index].wrap.remove(),i.index++,i.buildFlash()},window.MagicProps=t}}});_.Module.define({path:"ppb/widget/PbTrack",sub:{initial:function(){var n=this;$(".j_benba_search").click(function(){n._sendTrack("\u5427\u5185\u641C\u7D22\u70B9\u51FB","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),$(".j_search_post").click(function(){n._sendTrack("\u5168\u5427\u641C\u7D22","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),$(".share_thread").mouseover(function(){n._sendTrack("PB\u4E00\u697C\u5206\u4EAB","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),$(".p_sharebar").mouseover(function(){n._sendTrack("PB\u5E95\u90E8\u5206\u4EAB","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")});var c=setInterval(function(){$(".tbui_fbar_share").length&&($(".tbui_fbar_share").mouseover(function(){n._sendTrack("PB\u5DE6\u4FA7\u5206\u4EAB","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),clearInterval(c))},200);$("#tofrs_up").click(function(){n._sendTrack("PB\u9875\u8FD4\u56DEFRS\u94FE\u63A5-\u9875\u9996","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),$("#tofrs_down").click(function(){n._sendTrack("PB\u9875\u8FD4\u56DEFRS\u94FE\u63A5-\u9875\u5C3E","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),$(".tab_forumname").click(function(){n._sendTrack("PB\u9875\u8FD4\u56DEFRS\u4E3B\u9875\u6309\u94AE","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")});var e=setInterval(function(){$(".j_lzl_p_sv").length&&($(".j_lzl_p_sv").click(function(){n._sendTrack("\u697C\u4E2D\u697C\u8BED\u97F3\u6309\u94AE","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),clearInterval(e))},200),t=setInterval(function(){$(".edui-btn-voice").length&&($(".edui-btn-voice").click(function(){n._sendTrack("\u56DE\u590D\u6846\u8BED\u97F3\u6309\u94AE","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),clearInterval(t))},200);$(".v2_tab a").eq(3).click(function(){n._sendTrack("PB\u9875\u7CBE\u54C1\u6807\u7B7E","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")}),$(".sign_title_text_bright a").click(function(){n._sendTrack("\u7B7E\u5230\u6846\u4E0A\u4E0B\u7684\u5BA2\u6237\u7AEF\u63A8\u5E7F\u94FE\u63A5","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","pb")})},_sendTrack:function(n,c,e){$.stats.track(n,c,e,"click")}}});_.Module.define({path:"ppb/widget/specialAutoFocus",sub:{config:{url:{dolike:"/f/like/commit/add"}},initial:function(){var i=$.getPageData("user.user_id");this.userId=i,this.tbs=$.getPageData("tbs"),i&&this.doLike()},doLike:function(){var i=this,e={fid:"805227",fname:"galaxy",uid:i.userId,ie:"gbk",tbs:i.tbs};$.post(i.config.url.dolike,e,function(i){i&&0==i.no&&$("#j_head_focus_btn").removeClass("islike_focus").addClass("cancel_focus")},"json")}}});_.Module.define({path:"puser/widget/ticketWarning",requires:[],sub:{_dialog:[],_tpl:['<div class="ticket_video_main clearfix">','<div class="ticket_video_pic"><img src="',"<%=image_url%>",'" width="170" height="95"/></div>','<div class="ticket_video_intro">',"<h4>Hi, <%=user_name%></h4>","<p>\u60A8\u8D2D\u4E70\u7684<%=ticket_name%>\u5C06\u4E8E<span><%=end_time%></span> \u5F00\u59CB\u6F14\u51FA\u3002</p>","<p>\u8BB0\u5F97\u5230\u65F6\u89C2\u770B\u54E6~</p>","</div>","</div>",'<div class="ticket_video_operate">','<a href="#" class="ticket_video_btn ticket_video_ok_btn j_ticket_video_ok_btn">\u6211\u77E5\u9053\u4E86</a>','<a href="<%=link_url%>" target="_blank" class="ticket_video_btn ticket_video_go_btn j_ticket_video_go_btn">\u5148\u53BB\u770B\u770B</a>',"</div>"].join(""),i:0,initial:function(t){var i=this;if(t){var e=[];for(var _ in t)e.push({live_id:_,id:t[_].id});$.post("/starshow/browse/ticket/getTicketList",{ticket_id:e},function(e){var _=e.data;for(var a in _)_[a][0].end_time_str=t[a].end_time_str,i.showPop(_[a][0])},"json")}},showPop:function(t){var i=this,e=1e3*t.show_time,_=$.tb.Storage.get("ticket_seed_"+t.ticket_name),a=$.tb.Storage.get("ticket_close_"+t.ticket_name);_>=e||a||1*new Date<e-864e5||1*new Date>e||setTimeout(function(){i.initDialog(t),i.bindEvents()},2e3*this.i++)},initDialog:function(t){var i={user_name:PageData.user.user_name,ticket_name:t.ticket_name,end_time:t.end_time_str,link_url:"http://tieba.baidu.com/"+t.forum_name,image_url:t.image_url},e=baidu.template(this._tpl,i);this._dialog.push(new $.dialog({html:e,title:i.ticket_name+"\u5F00\u6F14\u63D0\u9192",width:520,height:260})),this._dialog[this._dialog.length-1].onclose(function(){$.tb.Storage.set("ticket_seed_"+t.ticket_name,t.end_time)}),$(this._dialog[this._dialog.length-1].element).tbattr("data-tname",t.ticket_name)},bindEvents:function(){var t=this,i=$(this._dialog[this._dialog.length-1].element);i.on("click",".j_ticket_video_ok_btn",function(e){e.preventDefault(),t._dialog[t._dialog.length-1].close(),t._dialog=t._dialog.slice(0,-1);var _=i.tbattr("data-tname");$.tb.Storage.set("ticket_close_"+_,1)}).on("click",".j_ticket_video_go_btn",function(){t._dialog[t._dialog.length-1].close(),t._dialog=t._dialog.slice(0,-1)})}}});_.Module.define({path:"ppb/widget/fixedBar",sub:{initial:function(){$("#fixed_bar .close").on("click",function(){$("#fixed_bar").hide()})}}});_.Module.define({path:"common/widget/Tdou/TdouViewPay",requires:["common/widget/Tdou/TdouBuilder","common/widget/Tdou/TdouData","common/widget/Tdou/TdouViewUtil","common/widget/Tdou/TdouViewAutoRedirect","common/widget/Tdou/TdouViewOperationBootstrap","common/widget/payMember"],sub:{errors:{110000:"\u7528\u6237\u672A\u767B\u9646",2320007:"\u7CFB\u7EDF\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",210009:"\u7CFB\u7EDF\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",2270044:"\u8D26\u53F7\u5F02\u5E38\uFF0C\u8BF7\u91CD\u65B0\u767B\u9646",2270047:"\u652F\u4ED8\u5931\u8D25\u2014\u8BA2\u5355\u5931\u6548",2270050:"\u8BA2\u5355\u72B6\u6001\u5F02\u5E38",2270049:"\u5546\u54C1\u8FC7\u671F\uFF0C\u8BF7\u91CD\u65B0\u8D2D\u4E70",2270015:"\u5546\u54C1\u4E0D\u53EF\u5151\u6362",2270051:"\u7CFB\u7EDF\u7EF4\u62A4\u4E2D..."},order_status:{0:"\u652F\u4ED8\u672A\u5B8C\u6210\uFF01",1:"\u652F\u4ED8\u6210\u529F\uFF0C\u5546\u54C1\u5151\u6362\u4E2D\uFF01",2:"\u5151\u6362\u6210\u529F",3:"\u5151\u6362\u5931\u8D25\uFF0CT\u8C46\u5DF2\u9000\u8FD8",4:"\u5151\u6362\u8D85\u65F6\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458"},tdou_buy_confirm_tag:"tdou_buy_confirm",is_iframe:!0,initial:function(e){this.builder=this.requireInstance("common/widget/Tdou/TdouBuilder"),this.dataProxy=this.requireInstance("common/widget/Tdou/TdouData"),this.viewUtil=this.requireInstance("common/widget/Tdou/TdouViewUtil"),this.message=e,this.autoDirect=this.requireInstance("common/widget/Tdou/TdouViewAutoRedirect")},createMain:function(e){var o=this;o.notShowSucTips=e.notShowSucTips,o.dataProxy.getPayInfo(e,o.onPayInfo,o)},onPayInfo:function(e){var o=this;if(e&&0===e.no){var t=e.data.goods_info,i=e.data.order_info,r=e.data.user_info;o.pay_info={goods_info:t,order_info:i,user_info:r},o.createUI(t,i,r)}else o.handleError(e.no)},createUI:function(e,o,t){var i=this,r="",n=t.Parr_props;i.dataProxy.setParrProps(n);var a=i.dataProxy.getMemberLevel(),d=2==a,u=t.Parr_scores,_=0;u&&(_=u.scores_money+u.scores_other);var s=_>=e.tdou_num,c=0;s||(c=e.tdou_num-_);var m=e.free_vip_level;if(s&&(o.cpath.pay_cashier||void 0==o.cpath.pay_cashier))return i.pay(!1),void 0;if(!s&&(o.cpath.gettdou_cashier||void 0==o.cpath.gettdou_cashier))return i.getTdou(!1),void 0;var l=i.confirmCount();return s&&l>0?(l-=1,i.confirmCount(l),i.pay(!1),void 0):(d&&m?r=i.createUI_memberGetTdou_free(s,e,o,c):d&&!m?r=i.createUI_memberGetTdou(s,e,o,c):!d&&m?r=i.createUI_nonMemberGetGoodsOwnedMember(s,e,o,c):d||m||(r=i.createUI_nonMemberGetTdouOwnedMember(s,e,o,c)),i.renderMain(r),i.initUIData(),i.bindMainUIEvents(),void 0)},directToCrasher:function(e,o,t){var i=this,r=t.Parr_props;i.dataProxy.setParrProps(r);var n=t.Parr_scores,a=0;n&&(a=n.scores_money+n.scores_other);var d=a>=e.tdou_num,u=0;d||(u=e.tdou_num-a),d?i.pay(!1):i.getTdou(!1)},initUIData:function(){var e=this,o=e.confirmCount(),t=$(".j_baidu_tb_tdou_pay_info_box .j_tdou_buy_confirm");t.length>0&&(parseInt(o)>0?t.tbattr("checked",!0):t.tbattr("checked",!1))},createUI_nonMemberGetGoodsOwnedMember:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_nonMemberGetGoodsOwnedMember(e,o,t,i);return r},createUI_nonMemberGetTdouOwnedMember:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_nonMemberGetTdouOwnedMember(e,o,t,i);return r},createUI_memberGetTdou:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_memberGetTdou(e,o,t,i);return r},createUI_memberGetTdou_free:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_memberGetTdou_freeGoods(e,o,t,i);return r},renderMain:function(e){if(!($(".baidu_tb_tdou_payment_dialog").length>0)){var o={modal:!0,showTitle:!1,fixed:!0,width:610,height:275,holderClassName:"baidu_tb_tdou_payment_dialog",draggable:!0};o.html=e,this._dialog=new $.dialog(o),this._dialog.element[0].id="baidu_tb_tdou_payment_dialog",this._dialog.show()}},bindMainUIEvents:function(){var e=this;if(!e._dialog)return!1;var o=e._dialog.element;o.find(".j_tdou_pay_header_close").on("click",function(){e.closeMain(),e.sendMessage("closed","");var o=e.requireInstance("common/widget/Tdou/TdouViewOperationBootstrap"),t={actionType:"CLOSE_PAYMENT"};o.triggerByScene(t,e.pay_info)}),o.delegate(".j_tb_tdou_pay_btn","click",function(){e.pay()}).delegate(".j_tb_tdou_get_tdou_btn","click",function(){e.getTdou()}).delegate(".j_tdou_enable_member","click",function(){var e=$(".j_baidu_tb_tdou_pay_info_box .j_tb_tdou_get_tdou_btn");$(this).tbattr("checked")?(e.html("\u5F00\u901A\u4F1A\u5458\u5E76\u83B7\u53D6T\u8C46"),e.addClass("tdou_pay_btn_135")):(e.html("\u83B7\u53D6T\u8C46"),e.removeClass("tdou_pay_btn_135"))}).delegate(".j_tdou_buy_confirm","click",function(){$(this).tbattr("checked")?e.confirmCount(30):e.confirmCount(0)}).delegate(".j_tdou_buy_icon","click",function(){e.getIcon()}).delegate(".j_tdou_open_super_member_link","click",function(){e.closeMain();var o=e.requireInstance("common/widget/payMember"),t={fr:"tbui_tdou_view_pay"};o.showCashier(t)})},pay:function(e){var o=this,t=e;"undefined"==typeof e&&(t=!0);var i={no_ui:t};o.dataProxy.payGoods(o.onPay,o,i)},onPay:function(e,o){var t=this;o&&!o.no_ui?t.wrap=null:(t.wrap=null,t.closeMain());var i=t.dataProxy.getPayInfoCache();if(0===e.no){var r={from:i.order_info.from,goods_name:$.tb.subByte(i.goods_info.goods_name,24,""),order_status:e.data.order_info.status,price:i.goods_info.tdou_num};t.viewUtil.displayPaymentSuccess(t.wrap,r,function(){t.closeMain(),t.sendMessage("paid",e)},t,t.notShowSucTips)}else t.viewUtil.displayPaymentFailed(t.wrap,$.tb.subByte(i.goods_info.goods_name,24,""),function(){t.closeMain(),t.sendMessage("paid",e)},t)},getTdou:function(e){var o=this,t=!1,i=e;"undefined"==typeof e&&(i=!0),i?(t=$(".j_baidu_tb_tdou_pay_info_box .j_tdou_enable_member").tbattr("checked"),this.closeMain()):t=!1;var r=o.dataProxy.getPayInfoCache(),n=r.order_info.cpath,a={consumption_path:r.order_info.scene_id,title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u83B7\u53D6T\u8C46",need_tdou:0,third_order_id:r.order_info.order_id,goods_cost_tdou:r.goods_info.tdou_num};t?($.extend(a,{title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458,\u83B7\u53D6T\u8C46",pay_type:7,tbs:r.tbs}),n&&"1"==n.purchase&&$.extend(a,{title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458,\u83B7\u53D6T\u8C46,\u8D2D\u4E70\u5546\u54C1",pay_type:9,tbs:r.tbs})):n&&"1"==n.purchase&&$.extend(a,{title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u8D2D\u4E70\u5546\u54C1,\u83B7\u53D6T\u8C46",pay_type:8,third_order_id:r.order_info.order_id,tbs:r.tbs}),o.goCashier(a,i)},goCashier:function(e,o){var t=this,i={consumption_path:e.consumption_path,title:e.desc,need_tdou:e.current_need_tdou,goods_cost_tdou:e.goods_cost_tdou||0,pay_type:e.pay_type||6,tbs:e.tbs,order_id:e.third_order_id,is_dialog:!o,pay_info:t.pay_info};this.autoDirect.display_type="third_app",this.autoDirect.third_order_id=e.third_order_id,this.autoDirect.createMain(i)},getIcon:function(){var e=this;e.closeMain();var o=e.dataProxy.getPayInfoCache();e.view=this.requireInstance("common/widget/Tdou/TdouView"),e.view.bind("after_buy_icon",function(t,i){var r=o.goods_info,n=o.order_info,a=o.user_info;null!=i&&(a.Parr_scores=i),e.createUI(r,n,a)},e);var t=o.order_info.scene_id,i="\u7B2C\u4E09\u65B9\u8D2D\u4E70icon",r=o.goods_info.tdou_num;e.view.createMain(t,i,r)},closeMain:function(){this._dialog&&this._dialog.close(),this.dialog=null},confirmCount:function(){var e=this,o=arguments[0],t=0,i=new Date,r=i.getFullYear()+""+(i.getMonth()+1)+i.getDate();if("undefined"!=typeof o){t=parseInt(o);var n=r+"#"+t;$.tb.Storage.set(e.tdou_buy_confirm_tag,n)}else{if(o=$.tb.Storage.get(e.tdou_buy_confirm_tag),null==o)return 0;var a=o.split("#");t=a&&2==a.length&&a[0]==r?parseInt(a[1]):0}return t},sendMessage:function(e,o){var t=this,i=null;"closed"==e?i={command:"encourage_dialog_closed",data:o}:"paid"==e&&(i={command:"encourage_paid",data:o}),t.message&&t.message(i)},handleError:function(e){if(e){var o=this,t=o.errors[e];return 11e4==e?(o.viewUtil.OpenLoginDialog(),void 0):(t?o.viewUtil.displayPaymentError(t):o.viewUtil.displayPaymentError("\u672A\u77E5\u9519\u8BEF"),void 0)}}}});_.Module.define({path:"pcommon/widget/Tdou/TdouViewPay",requires:["pcommon/widget/Tdou/TdouBuilder","pcommon/widget/Tdou/TdouData","pcommon/widget/Tdou/TdouViewUtil","pcommon/widget/Tdou/TdouViewAutoRedirect","pcommon/widget/Tdou/TdouViewOperationBootstrap","pcommon/widget/payMember"],sub:{errors:{110000:"\u7528\u6237\u672A\u767B\u9646",2320007:"\u7CFB\u7EDF\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",210009:"\u7CFB\u7EDF\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",2270044:"\u8D26\u53F7\u5F02\u5E38\uFF0C\u8BF7\u91CD\u65B0\u767B\u9646",2270047:"\u652F\u4ED8\u5931\u8D25\u2014\u8BA2\u5355\u5931\u6548",2270050:"\u8BA2\u5355\u72B6\u6001\u5F02\u5E38",2270049:"\u5546\u54C1\u8FC7\u671F\uFF0C\u8BF7\u91CD\u65B0\u8D2D\u4E70",2270015:"\u5546\u54C1\u4E0D\u53EF\u5151\u6362",2270051:"\u7CFB\u7EDF\u7EF4\u62A4\u4E2D..."},order_status:{0:"\u652F\u4ED8\u672A\u5B8C\u6210\uFF01",1:"\u652F\u4ED8\u6210\u529F\uFF0C\u5546\u54C1\u5151\u6362\u4E2D\uFF01",2:"\u5151\u6362\u6210\u529F",3:"\u5151\u6362\u5931\u8D25\uFF0CT\u8C46\u5DF2\u9000\u8FD8",4:"\u5151\u6362\u8D85\u65F6\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458"},tdou_buy_confirm_tag:"tdou_buy_confirm",is_iframe:!0,initial:function(e){this.builder=this.requireInstance("pcommon/widget/Tdou/TdouBuilder"),this.dataProxy=this.requireInstance("pcommon/widget/Tdou/TdouData"),this.viewUtil=this.requireInstance("pcommon/widget/Tdou/TdouViewUtil"),this.message=e,this.autoDirect=this.requireInstance("pcommon/widget/Tdou/TdouViewAutoRedirect")},createMain:function(e){var o=this;o.dataProxy.getPayInfo(e,o.onPayInfo,o)},onPayInfo:function(e){var o=this;if(e&&0===e.no){var t=e.data.goods_info,i=e.data.order_info,r=e.data.user_info;o.pay_info={goods_info:t,order_info:i,user_info:r},o.createUI(t,i,r)}else o.handleError(e.no)},createUI:function(e,o,t){var i=this,r="",n=t.Parr_props;i.dataProxy.setParrProps(n);var a=i.dataProxy.getMemberLevel(),d=2==a,_=t.Parr_scores,u=0;_&&(u=_.scores_money+_.scores_other);var s=u>=e.tdou_num,c=0;s||(c=e.tdou_num-u);var m=e.free_vip_level;if(s&&(o.cpath.pay_cashier||void 0==o.cpath.pay_cashier))return i.pay(!1),void 0;if(!s&&(o.cpath.gettdou_cashier||void 0==o.cpath.gettdou_cashier))return i.getTdou(!1),void 0;var l=i.confirmCount();return s&&l>0?(l-=1,i.confirmCount(l),i.pay(!1),void 0):(d&&m?r=i.createUI_memberGetTdou_free(s,e,o,c):d&&!m?r=i.createUI_memberGetTdou(s,e,o,c):!d&&m?r=i.createUI_nonMemberGetGoodsOwnedMember(s,e,o,c):d||m||(r=i.createUI_nonMemberGetTdouOwnedMember(s,e,o,c)),i.renderMain(r),i.initUIData(),i.bindMainUIEvents(),void 0)},directToCrasher:function(e,o,t){var i=this,r=t.Parr_props;i.dataProxy.setParrProps(r);var n=t.Parr_scores,a=0;n&&(a=n.scores_money+n.scores_other);var d=a>=e.tdou_num,_=0;d||(_=e.tdou_num-a),d?i.pay(!1):i.getTdou(!1)},initUIData:function(){var e=this,o=e.confirmCount(),t=$(".j_baidu_tb_tdou_pay_info_box .j_tdou_buy_confirm");t.length>0&&(parseInt(o)>0?t.tbattr("checked",!0):t.tbattr("checked",!1))},createUI_nonMemberGetGoodsOwnedMember:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_nonMemberGetGoodsOwnedMember(e,o,t,i);return r},createUI_nonMemberGetTdouOwnedMember:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_nonMemberGetTdouOwnedMember(e,o,t,i);return r},createUI_memberGetTdou:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_memberGetTdou(e,o,t,i);return r},createUI_memberGetTdou_free:function(e,o,t,i){o.tdou_pay_from=t.from;var r=this.builder.buildPayTdouMain_memberGetTdou_freeGoods(e,o,t,i);return r},renderMain:function(e){if(!($(".baidu_tb_tdou_payment_dialog").length>0)){var o={modal:!0,showTitle:!1,fixed:!0,width:610,height:275,holderClassName:"baidu_tb_tdou_payment_dialog",draggable:!0};o.html=e,this._dialog=new $.dialog(o),this._dialog.element[0].id="baidu_tb_tdou_payment_dialog",this._dialog.show()}},bindMainUIEvents:function(){var e=this,o=e._dialog.element;o.find(".j_tdou_pay_header_close").on("click",function(){e.closeMain(),e.sendMessage("closed","");var o=e.requireInstance("pcommon/widget/Tdou/TdouViewOperationBootstrap"),t={actionType:"CLOSE_PAYMENT"};o.triggerByScene(t,e.pay_info)}),o.delegate(".j_tb_tdou_pay_btn","click",function(){e.pay()}).delegate(".j_tb_tdou_get_tdou_btn","click",function(){e.getTdou()}).delegate(".j_tdou_enable_member","click",function(){var e=$(".j_baidu_tb_tdou_pay_info_box .j_tb_tdou_get_tdou_btn");$(this).tbattr("checked")?(e.html("\u5F00\u901A\u4F1A\u5458\u5E76\u83B7\u53D6T\u8C46"),e.addClass("tdou_pay_btn_135")):(e.html("\u83B7\u53D6T\u8C46"),e.removeClass("tdou_pay_btn_135"))}).delegate(".j_tdou_buy_confirm","click",function(){$(this).tbattr("checked")?e.confirmCount(30):e.confirmCount(0)}).delegate(".j_tdou_buy_icon","click",function(){e.getIcon()}).delegate(".j_tdou_open_super_member_link","click",function(){e.closeMain();var o=e.requireInstance("pcommon/widget/payMember"),t={fr:"open_super_member_link"};o.showCashier(t)})},pay:function(e){var o=this,t=e;"undefined"==typeof e&&(t=!0);var i={no_ui:t};o.dataProxy.payGoods(o.onPay,o,i)},onPay:function(e,o){var t=this;o&&!o.no_ui?t.wrap=null:(t.wrap=null,t.closeMain());var i=t.dataProxy.getPayInfoCache();if(0===e.no){var r={from:i.order_info.from,goods_name:$.tb.subByte(i.goods_info.goods_name,24,""),order_status:e.data.order_info.status,price:i.goods_info.tdou_num};t.viewUtil.displayPaymentSuccess(t.wrap,r,function(){t.closeMain(),t.sendMessage("paid",e)},t)}else t.viewUtil.displayPaymentFailed(t.wrap,$.tb.subByte(i.goods_info.goods_name,24,""),function(){t.closeMain(),t.sendMessage("paid",e)},t)},getTdou:function(e){var o=this,t=!1,i=e;"undefined"==typeof e&&(i=!0),i?(t=$(".j_baidu_tb_tdou_pay_info_box .j_tdou_enable_member").tbattr("checked"),this.closeMain()):t=!1;var r=o.dataProxy.getPayInfoCache(),n=r.order_info.cpath,a={consumption_path:r.order_info.scene_id,title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u83B7\u53D6T\u8C46",need_tdou:0,third_order_id:r.order_info.order_id,goods_cost_tdou:r.goods_info.tdou_num};t?($.extend(a,{title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458,\u83B7\u53D6T\u8C46",pay_type:7,tbs:r.tbs}),n&&"1"==n.purchase&&$.extend(a,{title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458,\u83B7\u53D6T\u8C46,\u8D2D\u4E70\u5546\u54C1",pay_type:9,tbs:r.tbs})):n&&"1"==n.purchase&&$.extend(a,{title:"\u7B2C\u4E09\u65B9\u652F\u4ED8:\u8D2D\u4E70\u5546\u54C1,\u83B7\u53D6T\u8C46",pay_type:8,third_order_id:r.order_info.order_id,tbs:r.tbs}),o.goCashier(a,i)},goCashier:function(e,o){var t=this,i={consumption_path:e.consumption_path,title:e.desc,need_tdou:e.current_need_tdou,goods_cost_tdou:e.goods_cost_tdou||0,pay_type:e.pay_type||6,tbs:e.tbs,order_id:e.third_order_id,is_dialog:!o,pay_info:t.pay_info};this.autoDirect.display_type="third_app",this.autoDirect.third_order_id=e.third_order_id,this.autoDirect.createMain(i)},getIcon:function(){var e=this;e.closeMain();var o=e.dataProxy.getPayInfoCache();e.view=this.requireInstance("pcommon/widget/Tdou/TdouView"),e.view.bind("after_buy_icon",function(t,i){var r=o.goods_info,n=o.order_info,a=o.user_info;null!=i&&(a.Parr_scores=i),e.createUI(r,n,a)},e);var t=o.order_info.scene_id,i="\u7B2C\u4E09\u65B9\u8D2D\u4E70icon",r=o.goods_info.tdou_num;e.view.createMain(t,i,r)},closeMain:function(){this._dialog&&this._dialog.close(),this.dialog=null},confirmCount:function(){var e=this,o=arguments[0],t=0,i=new Date,r=i.getFullYear()+""+(i.getMonth()+1)+i.getDate();if("undefined"!=typeof o){t=parseInt(o);var n=r+"#"+t;$.tb.Storage.set(e.tdou_buy_confirm_tag,n)}else{if(o=$.tb.Storage.get(e.tdou_buy_confirm_tag),null==o)return 0;var a=o.split("#");t=a&&2==a.length&&a[0]==r?parseInt(a[1]):0}return t},sendMessage:function(e,o){var t=this,i=null;"closed"==e?i={command:"encourage_dialog_closed",data:o}:"paid"==e&&(i={command:"encourage_paid",data:o}),t.message&&t.message(i)},handleError:function(e){if(e){var o=this,t=o.errors[e];return 11e4==e?(o.viewUtil.OpenLoginDialog(),void 0):(t?o.viewUtil.displayPaymentError(t):o.viewUtil.displayPaymentError("\u672A\u77E5\u9519\u8BEF"),void 0)}}}});_.Module.define({path:"encourage/widget/npc_vote/npc_vote_action",sub:{initial:function(e){this._opt=e,this._bindEvents()},_bindEvents:function(){var e=this,t=this._opt.$root;t.on("click",".j-btn-vote",function(){if(!PageData.user.is_login)return e.requireInstanceAsync("common/widget/LoginDialog"),void 0;var a=$(this).data("id"),n=$(this).data("forumname");$.post("/celebrity/submit/voteNpc",{tbs:PageData.tbs,id:a},function(a){switch(a.no){case 0:t.find(".j_vote_npc_"+a.data.id).find(".j_vote_num").text(a.data.vote_num),e._success();break;case 952710:e._attention(n);break;case 11e4:e.requireInstanceAsync("common/widget/LoginDialog");break;case 952711:e._alert({msg:"\u5427\u7B49\u7EA7\u8FBE\u5230"+(a.data+1)+"\u7EA7\u624D\u80FD\u652F\u6301\u672C\u5427\u54E6"});break;case 952712:e._alert({msg:"\u60A8\u7533\u8BF7\u7684\u540D\u4EBA\u5DF2\u522B\u7533\u8BF7\u8FC7\u4E86~"});break;case 952713:e._alert({msg:"\u672C\u671F\u6295\u7968\u7ED3\u675F\uFF0C\u4E0B\u4E00\u671F\u5373\u5C06\u542F\u52A8\uFF0C\u656C\u8BF7\u671F\u5F85"});break;case 952709:e._alert({msg:"\u5F53\u524D\u7528\u6237\u4E0D\u662F\u5427\u4E3B"});break;case 65534:e._alert({msg:"\u6BCF\u5929\u53EA\u80FD\u7ED93\u4E2A\u5427\u6295\u7968 \u0CA5_\u0CA5"});break;case 65533:e._alert({msg:"\u6BCF\u5929\u53EA\u80FD\u7ED9\u4E00\u4E2A\u5427\u62951\u7968\uFF0C\u8BF7\u660E\u5929\u7EE7\u7EED\u652F\u6301"});break;case 65532:e._alert({msg:"IP\u4E00\u5929\u8D85\u8FC7500"});break;default:$.dialog.alert(a.error,{title:"\u63D0\u793A"})}})})},_success:function(){var e='<div class="npc-vote-dialog"><p>\u6295\u7968\u6210\u529F</p><div class="btn-group"><a href="/celebrity/rankHome#npc_vote" class="btn-default btn-small mr10 j-see-rank">\u67E5\u770B\u699C\u5355</a> <a href="javascript:;" class="btn-sub btn-small j_close">\u53D6 \u6D88</a></div></div>',t=this._alert({html:e});$(t.element).find(".j-see-rank").on("click",function(){t.close()})},_alert:function(e){var t=e.html||'<div class="npc-vote-dialog"><p>'+e.msg+'</p><div class="btn-group">  <a href="#" class="btn-default btn-small j_close">\u786E \u8BA4</a></div></div>',a=new $.dialog({width:380,html:t,title:"\u63D0\u793A",draggable:!1});return $(a.element).find(".j_close").on("click",function(){return a.close(),!1}),a},_attention:function(e){var t='<div class="npc-vote-dialog"><p>\u672A\u5173\u6CE8\u672C\u5427\u4E0D\u80FD\u6295\u7968\u54E6~</p><div class="btn-group"> <a href="/f?kw='+encodeURIComponent(e)+'" class="btn-default btn-small">\u53BB\u5173\u6CE8</a></div></div>';new $.dialog({width:350,html:t,title:"\u63D0\u793A",draggable:!1})}}});_.Module.define({path:"ppb/widget/threadRecommend",requires:["pcommon/component/SlideShow"],sub:{_slideConfig:{target:"#recom_scroll_list .recom_scroll_wrap",nav:"#recom_scroll_list .recom_scroll_navs",interval:5e3,prev:"#recom_scroll_list .recom_scrol_ctrl_l",next:"#recom_scroll_list .recom_scrol_ctrl_r",slide:{speed:400}},initial:function(t){this.args=t;var o;t.total>2?(this.slideShow=this.use("pcommon/component/SlideShow",this._slideConfig),o=this.args.modelid_array[0],$.stats.track("\u7B2C1\u9875\u6A21\u5757\u5C55\u793A\u91CF","pb\u5185\u5BB9\u63A8\u8350","pb","show",{obj_id:this.args.tid_array[0].join("_"),obj_type:o?o:""}),$("#recom_scroll_list .recom_scrol_ctrls").show()):($(".recom_boxes").show(),$(".recom_scroll_ctrls").hide()),o||(o=$(".thread_recommend [data-modelid]").data("modelid")),$.stats.track("\u6A21\u5757\u6574\u4F53\u5C55\u793A\u91CF","pb\u5185\u5BB9\u63A8\u8350","pb","show",{obj_id:this.args.tid_array[0].join("_"),obj_type:o?o:""}),this.bindEvents()},bindEvents:function(){var t=this,o="pb\u5185\u5BB9\u63A8\u8350";$(".thread_recommend [data-locate]").delegate("a","click",function(){var t=$(this).closest("[data-locate]").data("locate"),e=$(this).closest("[data-modelid]").data("modelid"),r=$(this).data("tid");$.stats.track(t,o,{obj_id:r,obj_type:e?e:""})}),$(".thread_recommend .recom_scrol_ctrl").on("click",function(){var e=$(this).data("locate");$.stats.track(e,o,"pb");var r=t.slideShow.current;r="\u4E0B\u4E00\u4E2A"==e?++r>=t.slideShow.total?0:r:--r<0?t.slideShow.total-1:r,console.log(r);var s="\u7B2C"+(r+1)+"\u9875\u6A21\u5757\u5C55\u793A\u91CF",a=t.args.tid_array[r].join("_"),l=t.args.modelid_array[r];$.stats.track(s,o,"pb","show",{obj_id:a,obj_type:l?l:""})})}}});_.Module.define({path:"adsense/widget/tpl_ext",requires:[],sub:{initial:function(e){this.requireInstanceAsync("padsense/widget/loader",[],function(t){"POST"===e.type&&t.allPost()})}}});_.Module.define({path:"pcommon/component/InterestSmiley",requires:["pcommon/component/PostorService","pcommon/component/image_water","pcommon/component/ScrollPanel"],sub:{path:"http://tb1.bdstatic.com/tb/cms/commonsub/editor/images/",_imgWaterPath:"http://tieba.baidu.com/tb/cms/commonsub/editor/images/",smileTip:{qw_x:["\u6CA1\u56FEBS","\u4E0D\u660E\u89C9\u5389","\u778E\u4E86\u72D7\u773C","\u5751\u7239","\u4E0D\u4F1A\u7231","\u8EBA\u67AA","\u767D\u5BCC\u7F8E","\u4E0D\u670D\u6765\u8FA9","\u5BF9\u4E0D\u8D77"],qw_cat:["\u5C0F\u5EA6\u718A\u60CA\u5413\u9053\uFF1A\u76F4\u5230\u6211\u819D\u76D6\u4E2D\u4E86\u4E00\u7BAD","\u6CE2\u6CE2\u55B7\u4E86\u53E3\u8840\u8BF4\uFF1A\u6211\u64E6","\u5C0F\u5EA6\u718A\u6254\u4E86\u4E2A\u80A5\u7682\uFF1A\u4F60\u61C2\u7684","\u5C0F\u5EA6\u718A\u79F0\u8D5E\u9053\uFF1A\u8FD9\u771F\u662F\u6781\u597D\u7684","\u5C0F\u5EA6\u718A\u6FC0\u52A8\u5730\u8BF4\uFF1A\u7ED9\u529B\uFF01","\u5E03\u9C81\u9119\u89C6\u5730\u8BF4\uFF1A\u4F60\u59B9","\u5C0F\u5EA6\u718A\u60B2\u4F24\u5730\u8BF4\uFF1A\u611F\u89C9\u4E0D\u4F1A\u518D\u7231\u4E86","\u738B\u53D4\u6DEB\u7B11\u5730\u8BF4\uFF1A\u697C\u4E0B\u600E\u4E48\u770B\uFF1F","\u5C0F\u5EA6\u718A\u6311\u8845\u5730\u8BF4\uFF1A\u5475\u5475","\u5C0F\u5EA6\u718A\u9876\u7740\u8D34\u8BF4\uFF1A\u4E13\u4E1A\u9876\u5E16\u53EA\u97002\u6BDB","\u5C0F\u5EA6\u718A\u62FF\u7740\u706B\u94B3\u8BF4\uFF1A\u706B\u94B3\u7559\u540D","\u8D34\u8D34\u75F4\u75F4\u5730\u8BF4\uFF1A\u697C\u4E3B\u597D\u4EBA\u4E00\u751F\u5E73\u5B89","\u5C0F\u5EA6\u718A\u620F\u8C11\u9053\uFF1A\u633D\u5C0A","\u5C0F\u5EA6\u718A\u644A\u5F00\u624B\u8BF4\uFF1A\u7136\u5E76\u5375","\u5E03\u9C81\u6324\u7740\u8D34\u8D34\u8BF4\uFF1A\u6324\u6324"]},smileTextTip:{qw_x:["\u6CA1\u56FE\u4F60\u8BF4\u4E2Axx","\u4E0D\u660E\u89C9\u5389","\u778E\u4E86\u72D7\u773C","\u5751\u7239","\u611F\u89C9\u4E0D\u4F1A\u518D\u7231\u4E86","\u8EBA\u7740\u4E5F\u4E2D\u67AA","\u767D\u5BCC\u7F8E","\u4E0D\u670D\u6765\u8FA9","\u5BF9\u4E0D\u8D77"],qw_cat:["\u76F4\u5230\u6211\u819D\u76D6\u4E2D\u4E86\u4E00\u7BAD","\u6211\u64E6","\u4F60\u61C2\u7684","\u8FD9\u771F\u662F\u6781\u597D\u7684","\u7ED9\u529B\uFF01","\u4F60\u59B9","\u611F\u89C9\u4E0D\u4F1A\u518D\u7231\u4E86","\u697C\u4E0B\u600E\u4E48\u770B\uFF1F","\u5475\u5475","\u4E13\u4E1A\u9876\u5E16\u53EA\u97002\u6BDB","\u706B\u94B3\u7559\u540D","\u697C\u4E3B\u597D\u4EBA\u4E00\u751F\u5E73\u5B89","\u633D\u5C0A","\u7136\u5E76\u5375","\u6324\u6324"]},smileNum:{qw_x:9,qw_cat:15},smilePrev:{qw_x:"qw_x_00",qw_cat:"qw_cat_00"},smileSmallPath:{qw_x:"qw_x",qw_cat:"qw_cat_small"},smileQueen:["qw_cat","qw_x"],smileBrowse:{qw_x:"qw_x_browse",qw_cat:"qw_cat_browse"},smileTemplate:{qw_x:"qw_x_template",qw_cat:"qw_cat_template"},_dialogShow:!1,_layerShow:!1,isValueChange:!0,_isPosting:!1,_width:215,_height:195,version:"?20130427",initial:function(e){var t={type:"editor",smileClass:"t_smile_bg",scrollBar:"",scrollCss:{padding:"0px"},scrollBarHide:function(){},scrollBarShow:function(){},container:"",dataPostor:{}},i=this;this.option=$.extend(!0,t,e),this.manager(),this.postorService=this.use("pcommon/component/PostorService"),this.wrapper=$(".wrap2"),this.bindPostor(),this._imageW=this.use("pcommon/component/image_water"),this._imageW.bind("onComplete",function(e,t){var o=t.response,s=o.info.pic_id_encode,n=(o.info.fullpic_width,o.info.fullpic_height,o.info.pic_water,"http://imgsrc.baidu.com/forum/pic/item/"+s+".jpg");i.postorHandler(n,i._textValue,"configSmile",i._width,i._height),i._progessBar(100,140),i._isPosting=!1}),this._imageW.bind("onError",function(e,t){i._isPosting=!1;var o={image:'<img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif">',subMessage:"\u53D1\u8D34\u5931\u8D25",message:t.errorMessage,dialogSet:{width:410,height:95,title:"\u53D1\u8868\u8D34\u5B50"}};i._showErrorTip(o,function(){return!0})}),this._imageW.bind("onProgressListen",function(e,t){i.loading.show(),i.dBtn.hide(),setTimeout(function(){i._progessBar(t.percent,140)},200)})},_progessBar:function(e,t){var i=e*t/100,o=this;o.loading.find(".s_progress_bar").width(i)},bindPostor:function(){var e=this;this.postorService.bind("onCheckEroor",function(){e.trigger("onsuccess"),e.destroyLayer()}),this.postorService.bind("onError",function(){e.trigger("onsuccess"),e.destroyLayer(),e.dBtn.show(),e.loading.hide()})},manager:function(){window.InterestSmileyManager?window.InterestSmileyManager.push(this):(window.InterestSmileyManager=[],window.InterestSmileyManager.push(this))},generic:function(){this.render("qw_cat"),this.eventInit()},render:function(e){var t=this.option,i=this,o=t.container,s=i._gSmile(e);i.scrollPanel=i.use("pcommon/component/ScrollPanel",{container:o,padding:i.option.scrollCss.padding,height:260,scrollBarHide:i.option.scrollBarHide,scrollBarShow:i.option.scrollBarShow,content:s})},_gSmile:function(e){var t=this.option,i=this,o="";if("all"==e)for(var s=i.smileQueen,n=0,a=s.length;a>n;n++)for(var r=s[n],l=i.smileNum[r],h=i.smilePrev[r],d=t.smileClass,c=1;l>=c;c++){var g=i.path+"qw_review/"+i.smileyName(h,c,"png");o+='<div class="s_image '+d+'" data-type="'+r+'" title="'+i.smileTip[r][c-1]+'"    data-num="'+c+'"><img src="'+g+'" /></div>'}else for(var r=e,l=i.smileNum[r],h=i.smilePrev[r],d=t.smileClass,c=1;l>=c;c++){var g=i.path+"qw_review/"+i.smileyName(h,c,"png");o+='<div class="s_image '+d+'" data-type="'+r+'" title="'+i.smileTip[r][c-1]+'"     data-num="'+c+'"><img src="'+g+'" /></div>'}return o},smileyName:function(e,t,i){var o="";return o=e,10>t&&(o+="0"),o=o+t+"."+i},shake:function(e,t,i,o){function s(){n>=0?(a.css({padding:0}),n%2==0?a.css({paddingLeft:r.easeInOut(0,o,n,i)}):a.css({paddingRight:r.easeInOut(0,o,n,i)}),n--,r.Timer=setTimeout(s,t)):clearTimeout(r.Timer)}var n=e,a=this.wrapper;this.Timer=setTimeout(s,t);var r=this},easeInOut:function(e,t,i,o){var s=i/o*2;return(1>s?Math.pow(s,3):(s-=2)*Math.pow(s,2)+2)*t/2+e},destroyLayer:function(){var e=this;e.layer&&1==e._layerShow&&(clearTimeout(e.Timer),$(".wrap2").css("padding",0),e.layer.stop(),e.layer.hide(),e._layerShow=!1),e.dialog&&e._dialogShow&&(e.dialog.hide(),e._dialogShow=!1),e.imageText&&(e.imageText.hide(),e.imageText.html(""))},eventInit:function(){var e=this.option,t=this.option.container,i=this;t.delegate(".s_image","click",function(){var t=$(this),o=t.data("type"),s=t.data("num"),n=i.smilePrev[o],a=i.path+i.smileBrowse[o]+"/"+i.smileyName(n,s,"gif");i.trigger("click");for(var r=($(document).height(),$(window)),l=r.height()/2-300,h=r.width()/2-500,d="fixed",c=h+270,g=window.InterestSmileyManager,m=0,p=g.length;p>m;m++)g[m].destroyLayer();$.browser.msie&&$.browser.version<7&&(l=$(window).scrollTop(),d="absolute"),i.imageText&&i.imageText.hide();var u=$.getzIndex();i.layer?(i.layer.tbattr("src",a+i.version),i.layer.css({width:1e3,height:1e3,top:l,zIndex:u,left:h,position:d,opacity:.1}),i.layer.tbattr("data-type",o),i.layer.tbattr("data-num",s),i.layer.tbattr("data-isTemplate","no"),i.layer.show(),i._layerShow=!0):(i.layer=$('<img src="'+a+i.version+'" data-type="'+o+'" data-isTemplate="no" data-num="'+s+'" style="width:1000px;height:1000px;top:'+l+"px;z-index:"+u+";opacity:0.1;left:"+h+"px;position:"+d+';" >'),$("body").append(i.layer),i._layerShow=!0),i.layer.animate({width:430,height:390,opacity:1,left:c},500,function(){$.browser.msie&&$.browser.version<7||($.browser.msie?i.shake(20,30,12,3):"sougou"==$.getBrowser().name?i.shake(20,25,16,4):i.shake(20,25,12,3)),i.renderDialog(l,c)}),$.stats.sendRequest("st_mod=editor&fr=tb0_forum&st_type=interestS&st_value="+e.type)})},_fTip:{isBlock:"\u60A8\u5DF2\u7ECF\u88AB\u5C01\u7981\uFF0C\u4E0D\u80FD\u53D1\u8D34",balv:' <a href="http://tieba.baidu.com/f/like/level?kw=d8" >4\u7EA7\u5934\u8854</a><br />\u4EE5\u4E0A\u4F1A\u5458\u53D1\u8D34\u3002',old:"\u62B1\u6B49\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u9650\u5427\u52A1\u56E2\u961F\u53CA\u6CE8\u518C\u6EE1\u4E00\u5B9A\u65F6\u95F4\u7684\u8001\u7528\u6237\u53D1\u8D34",bawu:"\u62B1\u6B49\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u9650\u5427\u52A1\u56E2\u961F\u53D1\u8D34",law:"\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34",balv_undefined:"\u62B1\u6B49\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u5141\u8BB8\u4E00\u5B9A\u7EA7\u522B\u4EE5\u4E0A\u4F1A\u5458\u53D1\u5E16"},cannotPost:function(e){var t=this;switch(t.trigger("onsuccess"),t.destroyLayer(),e){case"login":return _.Module.use("pcommon/component/LoginDialog",["","editor"]),void 0;case"noUn":return TbCom.process("User","buildUnameFrame","\u586B\u5199\u7528\u6237\u540D"," "),void 0}var i="\u60A8\u4E0D\u80FD\u8FDB\u884C\u53D1\u8D34\u64CD\u4F5C";""!=e&&(i=this._fTip[e]);var o={image:'<img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif">',subMessage:"\u53D1\u8D34\u5931\u8D25",message:i,dialogSet:{width:410,height:95,title:"\u53D1\u8868\u8D34\u5B50"}};t._showErrorTip(o,function(){return!0})},_showErrorTip:function(e,t){var i='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: "\u5B8B\u4F53";"><table style="width:90%"><tbody><tr><td width="60">'+e.image+'</td><td valign="middle" style="font-size:20px;line-height:22px;font-family: "\u9ED1\u4F53";">'+e.subMessage+"</td></tr></tbody></table>"+e.message+"</div>",o=$.dialog.alert(i,e.dialogSet);o.bind("onclose",t)},postorHandler:function(e,t,i,o,s){var n=this.postorService,a=this,r=(this.option.dataPostor,a._getData(e,i,t,o,s));n.postHandler({data:r,type:"reply",success:a.successCallback,context:a,error:a.errorCallback,captchaCloseCallback:function(){a.destroyLayer()}})},_getData:function(e,t,i,o,s){var n=this.option.dataPostor,a=this.postorService,r=$.extend(!0,{},n.data);r.content=UE.utils.html2ubb(a.genericRich({type:t,src:e,width:o,height:s,text:$.tb.escapeHTML(i)})),r.anonymous=0;var l=document.getElementById("sign_id"),h=document.getElementById("useSignName");return h&&h.checked&&l&&(r.sign_id=l.value),r},successCallback:function(e,t){t.trigger("onsuccess"),t.destroyLayer(),t.showSuccessTip(),t.refreshWebsite()},errorCallback:function(){},refreshWebsite:function(){setTimeout(function(){location.reload()},1e3)},showSuccessTip:function(){var e=($(document).height(),$(window)),t=e.scrollTop()+e.height()/2-50,i=e.width()/2-100,o=$.getzIndex(),s=$('<div style="position:absolute;z-index:'+o+'"><div class="editor_banned_tip_info"><span class="postor_success"></span><span style="">\u53D1\u8868\u6210\u529F!</span></div><div>');s.css({top:t,left:i}),s.appendTo($("body")),setTimeout(function(){s.fadeOut(300,function(){s.remove()})},1500)},addBubble:function(e){var t=this;if(!t.bubble){var i={content:"\u529F\u80FD\u5373\u5C06\u4E0A\u7EBF\uFF0C<br>\u656C\u8BF7\u671F\u5F85~",arrow_dir:"down",bubble_css:{top:0,left:50,width:100},arrow_pos:{left:45},attr:"  ",wrap:e,closeBtn:!1,level:1,arrowReq:!0},o=new UiBubbleTipBase(i);o.j_bubble.find(".j_content").css({backgroundColor:"white",border:"1px solid #848482",textAlign:"center"}),o.j_bubble.find(".ui_triangle_outter").css({color:"#848482"}),o.j_bubble.find(".ui_triangle_inner").css({color:"white"}),t.bubble=o}},_submit:function(){var e=this.postorService,t=this;if(!t._isPosting){t._isPosting=!0;var i=this.option.dataPostor,o=e.isCanPost(i.canPostor);if(o.canPost){var s=t.layer,n=s.tbattr("data-type"),a=s.tbattr("data-num"),r=t.textInput.val().trim();t._textValue=r;var l=t.smilePrev[n],h=t._imgWaterPath+t.smileTemplate[n]+"/"+t.smileyName(l,a,"gif");if(""==r||r==t.smileTextTip[n][a-1]){var d="http://tb2.bdstatic.com/tb/cms/commonsub/editor/images/"+t.smileSmallPath[n]+"/"+t.smileyName(l,a,"gif");t.postorHandler(d,r,"smiley",t._width,t._height),t._isPosting=!1}else t._imageWater(h,r,t.textStyle[n][a-1]),$.stats.sendRequest("st_mod=editor&fr=tb0_forum&st_type=interestS&st_value=zidingyi")}else{var n=o.type;t.cannotPost(n),t._isPosting=!1}}},_imageWater:function(e,t,i){var o=this,s=o.filterStyle(t,i),n={imageUrl:e+o.version,text:{content:t,x:i.x,y:i.y,width:i.width},font:{size:s.size,lineHeight:s.lineHeight,color:i.color,family:"\u5FAE\u8F6F\u96C5\u9ED1"}};return o._imageW?(o._imageW.merge(n),void 0):void 0},textStyle:{qw_x:[{x:180,y:158,width:148,height:126,lineHeight:32,color:"#ffffff",size:14},{x:60,y:155,width:170,height:95,lineHeight:24,color:"#557E90",size:14},{x:212,y:166,width:130,height:86,lineHeight:20,color:"#ffffff",size:14},{x:246,y:127,width:90,height:125,lineHeight:19,color:"#ffffff",size:14},{x:45,y:155,width:180,height:80,lineHeight:20,color:"#557E90",size:14},{x:45,y:164,width:178,height:70,lineHeight:18,color:"#ffffff",size:14},{x:222,y:102,width:130,height:107,lineHeight:21,color:"#557E90",size:14},{x:85,y:145,width:150,height:100,lineHeight:25,color:"#ffffff",size:14},{x:51,y:122,width:160,height:90,lineHeight:25,color:"#557E90",size:14}],qw_cat:[{x:201,y:65,width:181,height:153,lineHeight:32,color:"#670102",size:24},{x:230,y:62,width:150,height:164,lineHeight:30,color:"#670102",size:24},{x:205,y:63,width:176,height:153,lineHeight:30,color:"#670102",size:24},{x:221,y:74,width:164,height:145,lineHeight:30,color:"#670102",size:24},{x:244,y:51,width:137,height:169,lineHeight:26,color:"#670102",size:24},{x:213,y:77,width:163,height:154,lineHeight:28,color:"#670102",size:24},{x:213,y:77,width:170,height:146,lineHeight:33,color:"#670102",size:24},{x:230,y:70,width:158,height:115,lineHeight:28,color:"#670102",size:24},{x:203,y:66,width:187,height:130,lineHeight:31,color:"#670102",size:24},{x:243,y:70,width:138,height:160,lineHeight:30,color:"#670102",size:24},{x:249,y:65,width:134,height:157,lineHeight:26,color:"#670102",size:24},{x:197,y:82,width:182,height:140,lineHeight:28,color:"#670102",size:24},{x:216,y:69,width:166,height:126,lineHeight:33,color:"#670102",size:24},{x:228,y:87,width:161,height:124,lineHeight:28,color:"#670102",size:24},{x:186,y:60,width:195,height:86,lineHeight:31,color:"#670102",size:24}]},filterStyle:function(e,t){var i=e.length,o=(t.lineHeight,t.size,t.width,{lineHeight:t.lineHeight,size:t.size});if(i>0){var s=t.height*t.width,n=s/i;o.lineHeight=Math.ceil(Math.pow(n,.5)),o.size=Math.ceil(1.5*o.lineHeight/2.5)}return o.lineHeight>t.height&&(o.lineHeight=t.height),o.lineHeight<t.lineHeight&&(o.lineHeight=t.lineHeight),o.size<t.size&&(o.size=t.size),o},showSmileTemplate:function(e,t,i){var o=this,s=o.layer,n=s.tbattr("data-type"),a=s.tbattr("data-num"),r=o.smilePrev[n],l=s.tbattr("data-isTemplate"),h=o.path+o.smileTemplate[n]+"/"+o.smileyName(r,a,"gif"),d=o.textStyle[n][a-1],c=function(e){var t=o.textInput.val();return o.imageText?(o.imageText.html($.tb.escapeHTML(t)),o.imageText.css(e),o.imageText.show(),void 0):(o.imageText=$('<div class="s_image_text"></div>'),o.imageText.html($.tb.escapeHTML(t)),o.imageText.css(e),$("body").append(o.imageText),o.imageText.show(),void 0)},g="fixed";$.browser.msie&&$.browser.version<7&&(g="absolute");var m=o.filterStyle(o.textInput.val(),d),p={position:g,zIndex:i,width:d.width,lineHeight:m.lineHeight+"px",left:d.x+t,fontSize:m.size,color:d.color,fontFamily:"\u5FAE\u8F6F\u96C5\u9ED1",top:d.y+e};"yes"==l?c(p):(s.tbattr("src",h+o.version),s.tbattr("data-isTemplate","yes"),c(p))},renderDialog:function(e,t){var i=this,o=i.layer,s=o.tbattr("data-type"),n=o.tbattr("data-num"),a=i.smileTextTip[s][n-1];return i.sTop=e,i.sL=t,i.imageText&&i.imageText.hide(),i.dialog?(i.dialog.setPosition(t+30,e+390),i.dialog.element.css({zIndex:$.getzIndex()}),i.loading.find(".s_progress_bar").width(0),i.dBtn.show(),i.loading.hide(),i.zIndex=$.getzIndex(),i.isValueChange=!1,i.textInput.val(a),i.dialog.show(),i._dialogShow=!0,void 0):(i.zIndex=$.getzIndex(),i.textInput=$('<input value="'+a+'" class="s_text_input"/>'),i.replyBtn=$('<a href="#" style="float:left;" class=" ui_btn interest_smiley_dialog_btn interest_smiley_dialog_submit" alog-alias="qwsmile"><span><em>\u63D0\u4EA4</em></span></a>'),i.cancelBtn=$('<a class="ui_btn interest_smiley_dialog_btn interest_smiley_dialog_cancel">\u53D6\u6D88</a>'),i.dBtn=$('<div style="position:relative;">').append(i.textInput).append(i.replyBtn).append(i.cancelBtn),i.loading=$('<div class="s_loading_wrap"><div class="s_progress_w"><span class="s_progress_bar"></span></div><div class="s_loading_tip">\u5BA2\u5B98\u7A0D\u7B49\u4E0B\uFF0C\u6211\u4EEC\u6B63\u5728\u52AA\u529B\u4E3A\u60A8\u751F\u6210\u56FE\u7247\u4E2D<div></div>'),i.dContent=$("<div></div>").append(i.dBtn).append(i.loading),i.replyBtn.click(function(e){i._submit(),e.preventDefault(),e.stopPropagation(),$.stats.sendRequest("st_mod=editor&fr=tb0_forum&st_type=interestS&st_value=send")}),i.textInput.focus(function(){var e=$(this);setTimeout(function(){i._isSelect=!0,e.select()},10)}),i.textInput.bind("mousedown",function(){i._isSelect=!1}),$.subInput(i.textInput,30),i.textInput.keydown(function(e){var t=e||window.event;if(13==t.keyCode)return i._submit(),!1;var o=$.tb.getByteLength(i.textInput.val());return i._isSelect&&o>39&&i.textInput.val(""),i._isSelect=!1,i.showSmileTemplate(i.sTop,i.sL,i.zIndex),!0}),i.textInput.bind("input",function(){return i.isValueChange&&i.showSmileTemplate(i.sTop,i.sL,i.zIndex),i.isValueChange=!0,!0}),i.textInput.bind("propertychange",function(){return i.isValueChange&&i.showSmileTemplate(i.sTop,i.sL,i.zIndex),i.isValueChange=!0,!0}),i.cancelBtn.click(function(){i.trigger("onCancel"),i.destroyLayer()}),i.dialog=new $.dialog({html:i.dContent,modal:!1,escable:!1,showTitle:!1,top:e+390,left:t+30,closeable:!0,fixed:!0,autoCenter:!1,width:370,height:26,draggable:!1,closeable:!1}),i.dialog.element.removeClass("dialogJshadow"),i.dialog.element.addClass("interest_smiley_dialog"),i.dialog.element.find(".dialogJcontent").css({padding:"20px"}),i._dialogShow=!0,void 0)}}});_.Module.define({path:"pcommon/widget/AsideFloatBar",requires:["pcommon/component/InterestSmiley","puser/widget/MagicProps"],sub:{initial:function(t){"undefined"!=typeof PDC&&PDC.mark("c_afbavi"),this.options=t,this.$root=$('<ul class="tbui_aside_float_bar"></ul>');for(var e=0,a=t.buttons.length;a>e;e++){var i=t.buttons[e];this.addButton(i)}this.$root.appendTo("body");var r=this;r.relocate(),$(window).resize(function(){r.relocate()});var o=PageData.product;if("pb"==o&&(this.$root.find(".tbui_fbar_favor").on("mouseenter",function(){$.stats.track("PB\u60AC\u6D6E\u7231\u901B\u7684\u5427","\u8D34\u5427PC\u9875\u9762\u4F18\u5316","pb","click"),$(this).find(".tbui_aside_favor_list a").one("click",function(){$.stats.track("PB\u60AC\u6D6E\u7231\u901B\u5427\u5C55\u5F00\u5427","\u8D34\u5427PC\u9875\u9762\u4F18\u5316","pb","click")})}),this.$root.find(".tbui_fbar_square").on("click",function(){$.stats.track("\u79C0\u5427\u5BFC\u822A","pb_\u5427\u53F3\u4FA7\u5BFC\u822A","pb","click")})),"frs"==o&&this.$root.find(".tbui_fbar_square").on("click",function(){$.stats.track("\u79C0\u5427\u5BFC\u822A","frs_\u5427\u53F3\u4FA7\u5BFC\u822A","frs","click")}),"frs"==o||"pb"==o||"pb_bright"==o){if("frs"==o)var s=["\u79C0\u5427\u5BFC\u822A","\u53D1\u5E16","\u5237\u65B0","\u5206\u4EAB","\u7231\u901B\u7684\u8D34\u5427","\u63A8\u8350\u6E38\u620F","\u5B9E\u9A8C\u5BA4","\u8FD4\u56DE\u9876\u90E8"];else var s=["\u79C0\u5427\u5BFC\u822A","\u9B54\u6CD5\u9053\u5177","\u795E\u6765\u4E00\u53E5","\u5206\u4EAB","\u7231\u901B\u7684\u8D34\u5427","\u63A8\u8350\u6E38\u620F","\u5B9E\u9A8C\u5BA4","\u8FD4\u56DE\u9876\u90E8"];this.$root.delegate(".tbui_aside_fbar_button","mouseenter",function(t){var e=$(t.target),a=e.parent().index();o="pb"==o||"pb_bright"==o?"pb":"frs",$.stats.track(s[a]+"\u70B9\u51FB\u91CF","FRS/PB\u53F3\u4FA7\u5DE5\u5177\u680F\u7EDF\u8BA1",o,"click")})}},addButton:function(t){var e=$($.tb.format('<li class="tbui_aside_fbar_button tbui_fbar_#{btnName}"><a href="#"></a></li>',{btnName:t})),a=this["_"+t];a&&a.call(this,e)&&this.$root.append(e)},relocate:function(){$(window).width()<1105?this.$root.addClass("tbui_afb_compact"):this.$root.removeClass("tbui_afb_compact")},_square:function(t){return t.children().tbattr("href","/show/v"),t.children().tbattr("target","_blank"),!0},_top:function(t){var e=$(window);0==e.scrollTop()&&t.css("visibility","hidden"),t.click(function(){function t(){i=Math.floor(i/2),window.scrollTo(0,i),i>2?a=setTimeout(t,40):(window.scrollTo(0,0),clearTimeout(a))}var a=null,i=e.scrollTop();$.browser.msie?window.scrollTo(0,0):t()});var a,i=!1;return e.bind("scroll",function(){a&&clearTimeout(a),a=setTimeout(function(){e.scrollTop()>0?0==i&&(t.css("visibility","visible"),i=!0):i&&(t.css("visibility","hidden"),i=!1)},500)}),!0},_refresh:function(t){return t.click(function(){return window.Path?window.Path.refresh():$.tb.location.reload(),!1}),!0},_post:function(t){var e=this;return e.options.dealTab&&$(".j_publish").length?t.children().tbattr("href",$(".j_publish").tbattr("href").replace(/&amp;/g,"&")).tbattr("target","_blank"):(t.children().tbattr("href","#sub"),t.click(function(t){t.preventDefault(),t.stopPropagation(),setTimeout(function(){e.fire("wanna_post")},50)})),!0},_share:function(t){var e=$("#bdshare_tb_l");return 0==e.size()?!1:(this.options.is_post_visible?t.click(function(){var t='\u64CD\u4F5C\u5931\u8D25,\u8BE6\u89C1<a href="/helpcenter/index#/index">\u4E2A\u4EBA\u4E2D\u5FC3</a>~';$.dialog.alert(t,{title:"\u64CD\u4F5C\u5931\u8D25"})}):(e.delayhover({enterDelay:0,leaveDelay:700,mouseenter:function(){t.clearDelayHoverTimer()},mouseleave:function(){e.fadeOut()}}),t.delayhover({enterDelay:300,leaveDelay:700,mouseenter:function(){if(e.is(":visible"))e.clearDelayHoverTimer();else{var a=t.offset();a.top-=1,a.left=a.left-e.outerWidth()+1,e.css(a).fadeIn()}},mouseleave:function(){e.fadeOut()}}).click(function(t){t.preventDefault(),t.stopPropagation()})),!0)},_radar:function(t){var e=this;return t.find("a").append('<img src="http://tb2.bdstatic.com/tb/static-pcommon/img/toolbar/radar_51d309d.gif" class="tbui_radar_img" />'),t.find("a").tbattr({href:$.tb.unescapeHTML(e.options.radarData&&e.options.radarData.link),target:"_blank"}),t.on("mousedown","a",function(){$.stats.track("radar","radar_banner")}),$.browser.msie&&7==$.browser.version&&t.css("marginBottom","-4px"),$.browser.msie&&6==$.browser.version&&(t.append("<div></div>"),t.css("marginBottom","-3px")),!0},_tsukkomi:function(t){var e=this;$.browser.msie&&7==$.browser.version&&t.css("marginBottom","-4px"),$.browser.msie&&6==$.browser.version&&(t.append("<div></div>"),t.css("marginBottom","-3px"));var a=$('<div class="tbui_aside_smiley"></div>');return e.interestSmile=this.use("pcommon/component/InterestSmiley",{container:a,smileClass:"t_smile_bg",type:"toolbar",scrollCss:{padding:"9px 0px 0px 0px"},scrollBarHide:function(){a.width(296)},scrollBarShow:function(){a.width(306)},dataPostor:e.options.dataPostor}),e.interestSmile.generic(),t.append(a),t.children("a").click(function(t){t.preventDefault(),t.stopPropagation(),a.is(":visible")?a.fadeOut():(a.fadeIn(),e.interestSmile.scrollPanel&&e.interestSmile.scrollPanel.setHeight(260))}),!0},_favor:function(t){if(0==PageData.user.is_login)return!1;var e=[];if(PageData.user.user_forum_list&&PageData.user.user_forum_list.info&&(e=PageData.user.user_forum_list.info),PageData.user_forumlist&&PageData.user_forumlist.info&&(e=PageData.user_forumlist.info),0==e.length)return!1;$.browser.msie&&6==$.browser.version&&(t.append("<div></div>"),t.css("marginBottom","-3px"));var a=$('<ul class="tbui_aside_favor_list clearfix" id="tbui_aside_favor_list"></ul>');if(e.length>0){var i,r=e,o=!1;r.length<=8?i=r.length:(i=7,o=!0);for(var s=0;i>s;s++){var n={kw:encodeURIComponent(r[s].forum_name),forumName:$.tb.subByte(r[s].forum_name,12)};a.append($.tb.format('<li><a href="http://tieba.baidu.com/f?ie=utf-8&kw=#{kw}" target="_blank" class="ui_text_summary">#{forumName}</a></li>',n))}o&&a.append('<li><a target="_blank" class="ui_text_desc" href="http://tieba.baidu.com/home/forum?id='+PageData.user.portrait+'" class="aside_float_favforum_more">\u66F4\u591A&gt;&gt;</a></li>')}return a.hide().appendTo(t),t.delayhover({enterDelay:300,leaveDelay:700,mouseenter:function(){a.fadeIn()},mouseleave:function(){a.fadeOut()}}).children("a").click(function(t){t.preventDefault(),t.stopPropagation()}),a.delegate("a","mousedown",function(){if(PageData&&PageData.forum&&PageData.product){if($(this).hasClass("ui_text_desc"))return;var t={st_mod:"aside_bar",st_type:"enterba",st_from:PageData.product,st_uid:PageData.user.user_id,st_benba:encodeURIComponent(PageData.forum.forum_name),st_goto:encodeURIComponent($(this).text())};$.tb.Stats.sendRequest("http://tb1.bdstatic.com/tb/img/hive.gif",t)}}),!0},_lab:function(t){t.children().tbattr("target","_blank").tbattr("href","http://tieba.baidu.com/idea/index");var e=$("<div class='tbui_aside_lab_tip'></div>");if(t.append(e),$.tb.Storage.remove("close_cm_bubble"),"1"!=$.tb.Storage.get("close_mt_bubble")&&+new Date<+new Date(2014,5,19)){var a={content:"<span class='ui_text_emphasize'>\u6587\u5B57\u8F6C\u8868\u60C5</span>\u529F\u80FD\u4E0A\u7EBF\u5566\uFF0C\u5FEB\u6765\u5C1D\u9C9C\u5566~",arrow_dir:"right",bubble_css:{top:0,right:50,width:150},wrap:e,closeBtn:!0},i=new UiBubbleTipBase(a);i.bind("onclose",function(){$.tb.Storage.set("close_mt_bubble","1",(new Date).getTime()+6048e5),i.closeBubble()}),i.j_bubble.show()}return!0},_props:function(t){var e=this;return $.browser.msie&&6==$.browser.version&&(t.append("<div></div>"),t.css("marginBottom","-3px")),e.props=this.use("puser/widget/MagicProps",{wrap:t,propsData:e.options.propsData}),e.props.visible}}});